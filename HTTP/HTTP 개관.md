# HTTP 개관

### HTTP : 인터넷의 멀티미디어 배달부

- HTTP 는 전 세계의 웹 서버로부터 대량의 정보를 빠르고, 간편하고, 정확하게 사람들의 PC에 설치된 웹 브라우저로 옮겨준다
  - JPEG, HTML page, text file, MPEG 동영상, WAVE 음성파일, 자바 애플릿 등
- 신뢰성 있는 데이터 전송 프로토콜
  - 정보가 손상되거나 꼬이지 않음을 보장한다
  - 개발자는 인터넷의 결함이나 결함이나 약점에 대한 걱정 없이 애플리케이션의 고유 기능 구현하는데 집중 가능 하다



### 웹 클라이언트와 서버 

- 웹서버는 HTTP 프로토콜로 의사소통 한다
- 웹서버 : 인터넷의 데이터를 저장하고 HTTP 클라이언트가 요청한 데이터를 제공한다
- HTTP 클라이언트 : 웹 브라우저(익스플로어, 구글 크롬)



### 리소스

- 웹서버 : 웹 리소스를 관리하고 제공
- 웹 리소스 : 웹콘텐츠의 원천
  - 정적 파일 -> text 파일, HTML파일, 워드 파일 등등 
  - 동적 파일 -> 사용자에 따라, 시간에 따라 요청 정보에 따라 다른 웹 콘텐츠 생성



### 미디어 타입

- MIME (Multipurpose Internet Mail Extensions) : 웹에서 전송되는 객체에 붙이는 데이터 포맷 라벨

  - 본래 목적 : 각기 다른 전자메일 시스템 사이에 메시지가 오갈 때 겪는 문제점을 해결하기 위해 설계

- 웹서버는 모든 HTTP 객체 데이터에 MIME 타입을 붙인다

  - 웹브라우저는 서버로부터 객체를 돌려 받을 때, 다룰 수 있는 객체인지 MIME 타입을 통해 확인한다
  - ex. 이미지 파일 보여주기, HTML 파일 분석 or 포맷팅, 오디어 파일 재생, 특별 포맷의 파일을 다루기위해 외부 플러그인 설치

- ```header
  context-type : imge/jpeg
  ```

- MIME 타입

  - 주 타입(primary object type) / 부타입(subtype)
  - HTML : text/html
  - palin ASCII 텍스트 문서 : text/plain
  - JPEG : image/jpeg
  - GIF : image/gif



### URI

- 웹서버 리소스는 각자의 이름을 가지고 있기 때문에 클라이언트는 리소스를 지목 할수 있다
- **URI**(Uniform Resource Identifier) : 정보 리소스를 고유하게 식별하고 위치를 지정할 수 있다
- URI 종류 : URL(Uniform Resource Locator) / URN(Uniform Resource Name)
- http://www.joes-hardware.com/specials/saw-blade.gif
  - http:// -> HTTP 프로토콜을 사용하라
  - www.joes-hardware.com -> www.joes-hardware.com으로 이동하라
  - /specials/saw-blade.gif -> /specials/saw-blade.gif 라고 불리는 리소스를 가져와라
  - URL은 프로토콜, 서버, 리소스를 명시한다 



### URL

- **URL**(Uniform Resource Locator) : 특성 서버의 리소스에 대한 구체적인 위치를 서술
- 리소스가 어디에 있고 어떻게 접근 할 수 있는지 분명하게 알려준다.

| URL                                                         | 설명                                                         |
| ----------------------------------------------------------- | ------------------------------------------------------------ |
| http://www.oreilly.com/index.html                           | 오라일리 출판사 홈페이지의 URL                               |
| http://www.joes-hardware.com/inventory-check.cgi?item=12731 | 물품 #12731의 재고가 있는지 확인하는 프로그램에 대한 URL     |
| ftp://joe:tools4u@ftp.joes-hardware.com/locking-pliers.jif  | 비밀번호로 보호되는 FTP를 통해 locking-pilers.gif이미지 파일에 접근하는 URL |

- URL 표준 포맷
  - URL의 첫 번째 부분은 스킴이라고 불리는데, 리소스에 접근하기 위해 사용되는 프로토콜을 서술한다
  - 두번째 부분은 서버의 인터넷 주소를 제공
  - 마지막은 웹 서버 리소스를 가르킨다
- 오늘날의 대부분의 URI는 URN이다



### URN

- **URN**(Uniform Resource Name) : 리소스의 위치에 영향 받지 않는 유일무이한 이름
- 위치 독립적인 URN은 리소스를 여기저기로 옮기더라도 문제없이 동작한다
- 이름을 변하지 않게 유지하는 한, 여러 종류의 네트워크 접속 프로토콜로 접근해도 문제 없다
- 인터넷 표준문서 RFC2141
  - Urn:ietf:rfc:2141
- 아직 실험중인 상태, 채택 x
  - 리소스 위치를 분석하기 위한 인프라 자원이 필요 -> 없음



### 트랜잭션

- HTTP 트랜잭션 = 요청 명령( 클라 -> 서버 ) + 응답 결과 (서버 -> 클라)

  - HTTP 메세지 라고 불리는 정형화된 데이터 덩어리를 사용

- 요청명령

  ```
  GET /specials/saw-blade.fif HTTP/1.0
  Host:www.joes-hardware.com
  ```

- 응답결과

  ```
  HTTP/1.0 200 OK
  Content-type : image/gif
  Content-length : 8527
  ```

  

### 메서드

- HTTP는 HTTP 메서드라고 불리는 여러가지 종류의 요청 명령을 지우너한다
- HTTP 요청 메세지는 한 개의 메서드를 갖는다.
- 메서드는 서버에게 어떤 동작을 취해야하는지 말해준다
  - ex.) 웹페이지 가져오기, 게이트웨이 프로그램 실행하기, 파일 삭제하기
- 대표 메소드

| HTTP 메서드 | 설명                                                         |
| ----------- | ------------------------------------------------------------ |
| GET         | 서버에서 클라이언트로 지정한 리소스를 보내라.                |
| POST        | 클라이언트에서 서버로 보낸 데이터를 지정한 이름의 리소스로 저장해라 |
| DELETE      | 지정한 리소스를 서버에서 삭제해라                            |
| PUT         | 클라이언트 데이터를 서버 게이트웨이 애플리케이션으로 보내라  |
| HEAD        | 지정한 리소스에 대한 응답에서, HTTP 헤더 부분만 보내라       |



### 상태코드

- 모든 HTTP 응답 메세지는 상태코드와 함께 반환된다
- 클라이언트에게 요청이 성공했는 지 아니면 추가 조치가 필요한지 알려주는 세자리 숫자이다

| HTTP 상태코드 | 설명                                         |
| ------------- | -------------------------------------------- |
| 200           | OK. 문서가 올바르게 반환되었다               |
| 302           | 다시보내라. 다른 곳에 가서 리소스를 가져가라 |
| 404           | 에러. 리소스를 찾을 수 없다.                 |

- 상태코드에 텍스트로된 `사유구절`도 같이 보낸다 

```
200 OK
200 Document attached
200 Success
200 All's cool, dude
```



### 웹페이지 객체

- 웹페이지는 여러 객체로 이루어질 수 있다
- 하나의 작업을 수행하기 위해 여러 HTTP 트랜잭션을 수행한다
  - Ex.) HTML  뼈대 가져오기 -> 첨부된 이미지 가져오기 -> >그래픽 조각 -> 자바 애플릿 가져오기
- 웹페이지 -> 하나의 리소스 x, 리소스의 모음



### 메시지

- HTTP 메시지 == 단순 문자열
- 바이너리 파일 x, 텍스트 o
- 요청 메세지

```
GET /test/hi-there.txt HTTP/1.0 //시작줄
Accept: text/* 		//헤더
Accept-Language : en,fr
```

- 응답메세지

~~~
HTTP/1.0 200 OK 	//시작줄
Content-type: text/palin	//헤더
Content-length: 19

Hi I'm a message! //본문
~~~

- **시작줄** : 요청이라면 무엇을 해야하는지, 응답이라면 무슨일이 있어났는지를 나타냄
- **헤더 ** : 0개 이상의 헤더 필드가 이어짐, key- value 가 :로 구성,
  - <u>헤더는 빈줄로 끝난다</u>
- **본문** : 보낼 데이터를 본문에 담음



### TCP 커넥션

- HTTP는 애플리케이션 계층 프로토콜 이기 떄문에 네트워크 통신의 핵심적인 세부사항에 대해서 신경쓰지 않는다 
- TCP/IP 에게 네트워크 통신 핵심 세부사항을 맡긴다
  - 오류 없는 데이터 전송
  - 순서에 맞는 전달 (데이터는 언제나 보낸 순서대로 도착한다)
  - 조각 나지 않는 데이터 스트림 (언제든 어떤 크기로 보낼 수 있다)
- TCP/IP
  - TCP와 IP가 층을 이루는, 패킷 교환 네트워크 프로토콜 집합
  - 각 네트워크와 하드웨어 특성을 숨김
  - 어떤 종류의 컴퓨터나 네트워크든 서로 신뢰성 있는 의사소통을 할 수 있게 함
- TCP 커넥션이 맺어지는 과정
  - 메지를 주고 받기전 <u>인터넷 프로토콜 주소(IP)와 포트번호</u>를 사용해 클라이언트와 서버 사이의 **TCP/IP 커넥션**을 맺어야 한다
  - TCP에서는 서버 컴퓨터에 대한 IP 주소와 그 서버에서 실행중인 프로그램이 사용 중인 포트번호가 필요한다
  - 서버의 IP주소와 포트번호를 알아내는 방법?
    - URL을 이용
      - http://207.200.83.29:80/index.html
      - http://www.netscape.com:80/index.html
      - http://www.netscape.com/index.html
    - 두 번째와 세 번째 같은 경우 IP 주소 대신 호스트명을 가지고 있다
    - 호스트 명은 **DNS**(Domain Name Service)라 불리는 장치를 통해 쉽게 IP로 변환 될 수 있다
  - 커넥션을 맺는 과정
    1. 웹 브라우저는 서버의 URL에서 호스트 명을 추출한다
    2. 웹 브라우저는 서버의 호스트 명을 IP로 변환한다.
    3. 웹 브라우저는 URL에서 포트번호(있다면를 추출한다.
    4. 웹 브라우저는 웹서버와 TCP 커넥션을 맺는다
    5. 웹 브라우저는 서버에 HTTP 요청을 보낸다.
    6. 서버는 웹 브라우저에 HTTP 응답을 돌려준다.
    7. 커넥션이 닫히면, 웹브라우저는 문서를 보여준다.



### 프토콜 버전

- HTTP/0.9
  - 심각한 디자인 결함이 다수 있다
  - 구식 클라이언트하고 만 같이 사용할 수 있다
  - 오직 **GET** 메서드만 지원
  - 멀티미디어 콘텐츠에 대한 MIME 타입이나 HTTP 헤더, 버전번호는 지원하지 않는다
  - 간단한 HTML 객체를 받아 오기 위해 만들어진 것
- HTTP/1.0
  - 처음으로 널리 쓰이기 시작한 HTTP버전
  - HTTP 헤더, 추가 메서드, 멜티미디어 객체 처리 추가
- HTTP/1.0+
  - Keep-alive 커넥션, 가상 호스팅 지원, 프락시 연결 지원 등등
  - 많은 기준들이 HTTP에 추가됨
  - 확장된 HTTP 버전
- HTTP/1.1
  - HTTP 설계의 구조적 결함 교정
  - 두러진 성능 최적화
  - 잘못된 기능 제거 
  - 현재 버전
- HTTP/2.0
  - HTTP/1.1의 성능 개선을 위해 구글의 SPDY프로토콜을 기반으로 설계가 진행중인 프로토콜





### 웹의 구성요소

- 프락시 : 클라이언트와 서버 사이에 위치한 HTTP 중개자
- 캐시 : 많이 찾는 웹 페이지를 클라이언트 가까이에 보관하는 HTTP 창고
- 게이트 웨이 : 다른 애플리케이션과 연결된 특별한 웹서버
- 터널 : 단순히 HTTP 통신을 전달하기만 하는 특별한 프락시
- 에이전트 : 자동화된 HTTP 요청을 만드는 준지능적 웹클라이언트



##### 프락시

- 클라이언트의 모든 HTTP 요청을 받아 서버에 전달 (요청을 수행 한 뒤)
- 사용자를 위한 프락시로 동작하며 사용자를 대신하여 서버에 접근한다
- 주 보안을 위해 사용
  - 모든 웹 트래픽 흐름 속에서 신뢰할만한 중개자 역할을 한다 
- 요청과 응답을 필터링한다
  - 바이러스 검출, 성인 콘텐츠 차단



##### 캐시

- 자신을 거쳐 가는 문서들 중 자주 찾는 것의 사본을 저장 해 두는 특별한 종류의 프락시
- 클라이언트는 멀리 떨어진 웹 서버보다 근처의 캐시에서 훨씬 더 빠르게 문서를 받을 수 있다



##### 게이트웨이

- <u>다른 서버들의 중개자로 동작하는 특별한 서버</u>

- 게이트웨이는 주로 HTTP 트래픽을다른 프로토콜로 변환하기 위해 사용된다.
- 스스로가 리소스를 갖고 있는 진짜 서버인 것 처럼 요청을 다룬다
- HTTP/FTP 게이트워이는 FTP URI에 대한 HTTP 요청을 받아들인 뒤  FTP 프로토콜을 이용해 문서를 가져온다 



##### 터널

- 두 커넥션 사이에서 날(raw)데이터를 열어보지 않고 그대로 전달해 주는 HTTP 애플리케이션
- 비 HTTP 데이터를 하나 이상의 HTTP 연결을 통해 그대로 전송하기 위해 사용된다
- 암호화된 SSL 트래픽을 HTTP 커넥션으로 전송함으로써 웹 트래픽만 허용하는 사내 방화벽을 통과시키는 것



##### 에이전트

- 사용자를 위해 HTTP 요청을 만들어주는 클라이언트 프로그램
- 웹 요청을 만드는 애플리케이션은 뭐든 HTTP 에이전트다.
- Ex) 크롤링

